<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login - Shuprama Kitchen</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDky00JFeTZ0pVTnLQ-LRE_0Om92ZtLJeo",
      authDomain: "shuprama-tiffin-f6faf.firebaseapp.com",
      databaseURL: "https://shuprama-tiffin-f6faf-default-rtdb.firebaseio.com",
      projectId: "shuprama-tiffin-f6faf",
      storageBucket: "shuprama-tiffin-f6faf.firebasestorage.app",
      messagingSenderId: "513826845425",
      appId: "1:513826845425:web:01119dda2684c74bd3af50",
      measurementId: "G-ZT4Y0FH30W"
    };
    firebase.initializeApp(firebaseConfig);
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 15px;
    }

    .container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      max-width: 450px;
      width: 100%;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .logo {
      width: 80px;
      height: auto;
      margin-bottom: 20px;
      border-radius: 50%;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      border: 3px solid rgba(255, 107, 107, 0.2);
    }

    h2 {
      color: #2d3748;
      margin-bottom: 8px;
      font-size: 32px;
      font-weight: 700;
    }

    .subtitle {
      color: #718096;
      margin-bottom: 30px;
      font-size: 16px;
      font-weight: 400;
    }

    .toggle {
      color: #ff6b6b;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 30px;
      background: linear-gradient(135deg, #fff5f5, #fef5e7);
      padding: 14px 28px;
      border-radius: 15px;
      border: 2px solid #fed7d7;
      transition: all 0.3s ease;
      display: inline-block;
    }

    .toggle:hover {
      background: linear-gradient(135deg, #ff6b6b, #feca57);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
    }

    .section {
      margin-bottom: 25px;
      text-align: left;
    }

    label {
      display: block;
      color: #4a5568;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 16px;
    }

    input {
      width: 100%;
      padding: 18px;
      border-radius: 12px;
      border: 2px solid #e2e8f0;
      font-size: 16px;
      transition: all 0.3s ease;
      background: #f7fafc;
      font-family: 'Poppins', sans-serif;
    }

    input:focus {
      outline: none;
      border-color: #ff6b6b;
      background: white;
      box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
    }

    button {
      width: 100%;
      padding: 18px;
      margin-top: 20px;
      background: linear-gradient(135deg, #ff6b6b, #feca57);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 18px;
      font-family: 'Poppins', sans-serif;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    .link {
      font-size: 14px;
      margin-top: 12px;
      color: #ff6b6b;
      cursor: pointer;
      text-decoration: none;
      text-align: right;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    .link:hover {
      color: #feca57;
      text-decoration: underline;
    }

    .phone-toggle {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e2e8f0;
    }

    .phone-toggle-btn {
      background: none;
      border: 2px solid #e2e8f0;
      color: #718096;
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      margin: 0;
      width: auto;
      display: inline-block;
    }

    .phone-toggle-btn:hover {
      border-color: #ff6b6b;
      color: #ff6b6b;
      background: rgba(255, 107, 107, 0.05);
    }

    .phone-section {
      display: none;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #e2e8f0;
    }

    .phone-section.active {
      display: block;
    }

    #otp-section {
      display: none;
      margin-top: 20px;
    }

    .success-message {
      background: linear-gradient(135deg, #48bb78, #38a169);
      color: white;
      padding: 20px;
      border-radius: 12px;
      margin: 20px 0;
      font-weight: 600;
      font-size: 16px;
      box-shadow: 0 4px 12px rgba(72, 187, 120, 0.3);
      display: none;
    }

    .success-message.show {
      display: block;
    }

    .error-message {
      background: linear-gradient(135deg, #f56565, #e53e3e);
      color: white;
      padding: 15px;
      border-radius: 12px;
      margin: 15px 0;
      font-weight: 500;
      font-size: 14px;
      box-shadow: 0 4px 12px rgba(245, 101, 101, 0.3);
      display: none;
    }

    .error-message.show {
      display: block;
    }

    #message {
      color: #48bb78;
      font-weight: 600;
      margin-top: 15px;
      padding: 12px;
      background: rgba(72, 187, 120, 0.1);
      border-radius: 8px;
      border-left: 4px solid #48bb78;
    }

    #recaptcha-container {
      margin: 15px 0;
      display: flex;
      justify-content: center;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 30px 25px;
        margin: 10px;
        max-width: 95%;
      }
      
      h2 {
        font-size: 28px;
      }
      
      .subtitle {
        font-size: 15px;
      }
      
      input {
        padding: 16px;
        font-size: 16px;
      }
      
      button {
        padding: 16px;
        font-size: 16px;
      }
      
      label {
        font-size: 15px;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 25px 20px;
      }
      
      h2 {
        font-size: 24px;
      }
      
      .toggle {
        padding: 12px 20px;
        font-size: 14px;
      }
      
      input {
        padding: 14px;
        font-size: 15px;
      }
      
      button {
        padding: 14px;
        font-size: 15px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <img src="https://prateekshukla328.github.io/Shuprama/logo.png" alt="Shuprama Logo" class="logo" />
    <h2>Welcome Back</h2>
    <p class="subtitle">Sign in to your Shuprama Kitchen account</p>

    <div class="success-message" id="success-message"></div>
    <div class="error-message" id="error-message"></div>

    <div class="toggle" onclick="toggleMode()">Switch to Sign Up</div>

    <!-- Email Login/Signup -->
    <div class="section" id="email-section">
      <label>Email Address</label>
      <input type="email" id="email" placeholder="Enter your email address" />
      <label>Password</label>
      <input type="password" id="password" placeholder="Enter your password" />
      <div class="link" onclick="resetPassword()">Forgot Password?</div>
      <button onclick="loginOrSignup()">Login</button>
    </div>

    <!-- Phone Login Toggle -->
    <div class="phone-toggle">
      <button class="phone-toggle-btn" onclick="togglePhoneSection()">Login with Phone Number</button>
    </div>

    <!-- Phone Login Section (Hidden by default) -->
    <div class="phone-section" id="phone-section">
      <div class="section">
        <label>Phone Number</label>
        <input type="tel" id="phone" placeholder="+91XXXXXXXXXX" />
        <div id="recaptcha-container"></div>
        <button onclick="sendOTP()">Send OTP</button>

        <div id="otp-section">
          <label>Enter OTP</label>
          <input type="text" id="otp" placeholder="Enter 6-digit OTP" />
          <button onclick="verifyOTP()">Verify OTP</button>
        </div>
      </div>
    </div>

    <p id="message"></p>
  </div>

  <script>
    let isSignup = false;
    const auth = firebase.auth();

    function showSuccessMessage(message) {
      const successDiv = document.getElementById('success-message');
      successDiv.textContent = message;
      successDiv.classList.add('show');
      
      setTimeout(() => {
        successDiv.classList.remove('show');
      }, 3000);
    }

    function showErrorMessage(message) {
      const errorDiv = document.getElementById('error-message');
      errorDiv.textContent = message;
      errorDiv.classList.add('show');
      
      setTimeout(() => {
        errorDiv.classList.remove('show');
      }, 4000);
    }

    function getCustomerNameFromEmail(email) {
      return email.split('@')[0].replace(/[._]/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
    }

    function toggleMode() {
      isSignup = !isSignup;
      document.querySelector('.toggle').innerText = isSignup ? "Switch to Login" : "Switch to Sign Up";
      document.querySelector("#email-section button").innerText = isSignup ? "Sign Up" : "Login";
      document.querySelector('h2').innerText = isSignup ? "Create Account" : "Welcome Back";
      document.querySelector('.subtitle').innerText = isSignup ? "Join Shuprama Kitchen today" : "Sign in to your Shuprama Kitchen account";
    }

    function togglePhoneSection() {
      const phoneSection = document.getElementById('phone-section');
      const toggleBtn = document.querySelector('.phone-toggle-btn');
      
      if (phoneSection.classList.contains('active')) {
        phoneSection.classList.remove('active');
        toggleBtn.innerText = 'Login with Phone Number';
      } else {
        phoneSection.classList.add('active');
        toggleBtn.innerText = 'Hide Phone Login';
      }
    }

    function loginOrSignup() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      if (!email || !password) {
        showErrorMessage("Please fill in all fields");
        return;
      }

      const customerName = getCustomerNameFromEmail(email);

      if (isSignup) {
        auth.createUserWithEmailAndPassword(email, password)
          .then(() => {
            showSuccessMessage(`ðŸŽ‰ Welcome ${customerName}! Account created successfully!`);
            setTimeout(() => {
              saveSession();
              window.location.href = "index.html";
            }, 2000);
          })
          .catch(error => {
            showErrorMessage("Signup Error: " + error.message);
          });
      } else {
        auth.signInWithEmailAndPassword(email, password)
          .then(() => {
            showSuccessMessage(`âœ… Welcome back ${customerName}! Login successful!`);
            setTimeout(() => {
              saveSession();
              window.location.href = "index.html";
            }, 2000);
          })
          .catch(error => {
            showErrorMessage("Login Error: " + error.message);
          });
      }
    }

    function resetPassword() {
      const email = document.getElementById("email").value;
      if (!email) {
        showErrorMessage("Please enter your email first");
        return;
      }
      
      auth.sendPasswordResetEmail(email)
        .then(() => {
          showSuccessMessage("Password reset link sent to your email!");
        })
        .catch(error => {
          showErrorMessage("Error: " + error.message);
        });
    }

    function sendOTP() {
      const phoneNumber = document.getElementById("phone").value;
      if (!phoneNumber) {
        showErrorMessage("Please enter your phone number");
        return;
      }

      window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
        size: 'normal'
      });
      
      auth.signInWithPhoneNumber(phoneNumber, window.recaptchaVerifier)
        .then(confirmResult => {
          window.confirmationResult = confirmResult;
          document.getElementById("otp-section").style.display = "block";
          document.getElementById("message").innerText = "OTP sent successfully!";
        })
        .catch(error => {
          showErrorMessage("OTP Error: " + error.message);
        });
    }

    function verifyOTP() {
      const otp = document.getElementById("otp").value;
      if (!otp) {
        showErrorMessage("Please enter the OTP");
        return;
      }

      if (window.confirmationResult) {
        window.confirmationResult.confirm(otp)
          .then(() => {
            const phoneNumber = document.getElementById("phone").value;
            const customerName = phoneNumber.replace('+91', '').substring(0, 4) + '****';
            showSuccessMessage(`âœ… Welcome ${customerName}! Phone verification successful!`);
            setTimeout(() => {
              saveSession();
              window.location.href = "index.html";
            }, 2000);
          })
          .catch(error => {
            showErrorMessage("OTP Verification Failed: " + error.message);
          });
      }
    }

    function saveSession() {
      const user = auth.currentUser;
      if (user) {
        localStorage.setItem("user", JSON.stringify({
          uid: user.uid,
          email: user.email || '',
          phone: user.phoneNumber || ''
        }));
      }
    }
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'968d33bb357e857e',t:'MTc1NDEzMzc5NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
